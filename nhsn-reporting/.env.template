# NHSN Reporting Module Configuration
# Copy to .env and modify as needed

# =============================================================================
# Data Sources
# =============================================================================
# Note retrieval source: fhir, clarity, or both
NOTE_SOURCE=fhir

# FHIR server configuration
FHIR_BASE_URL=http://localhost:8081/fhir

# Clarity database (for Epic installs using Clarity for notes)
# CLARITY_CONNECTION_STRING=mssql+pyodbc://user:pass@server/CLARITY?driver=ODBC+Driver+17+for+SQL+Server

# =============================================================================
# LLM Backend (Ollama - Local, PHI-safe)
# =============================================================================
LLM_BACKEND=ollama
OLLAMA_BASE_URL=http://localhost:11434
OLLAMA_MODEL=llama3.1:70b

# Alternative: Claude API (requires BAA)
# LLM_BACKEND=claude
# CLAUDE_API_KEY=
# CLAUDE_MODEL=claude-sonnet-4-20250514

# =============================================================================
# Classification Thresholds
# =============================================================================
# Auto-confirm HAI above this confidence (no IP review needed)
AUTO_CLASSIFY_THRESHOLD=0.85

# Route to IP review above this threshold (below = manual review)
IP_REVIEW_THRESHOLD=0.60

# =============================================================================
# CLABSI Criteria
# =============================================================================
# Minimum device days before culture for CLABSI eligibility
MIN_DEVICE_DAYS=2

# Days after line removal that BSI can still be attributed
POST_REMOVAL_WINDOW_DAYS=1

# =============================================================================
# Database Paths
# =============================================================================
NHSN_DB_PATH=~/.aegis/nhsn.db
ALERT_DB_PATH=~/.aegis/alerts.db

# =============================================================================
# Monitoring
# =============================================================================
# Poll interval in seconds
POLL_INTERVAL=300

# Hours to look back for new cultures
LOOKBACK_HOURS=24

# =============================================================================
# Notifications
# =============================================================================
TEAMS_WEBHOOK_URL=
# Dashboard URL (for action buttons in Teams alerts)
# Development:
# DASHBOARD_BASE_URL=http://localhost:5000
# Production:
DASHBOARD_BASE_URL=https://aegis-asp.com

# =============================================================================
# Note Processing
# =============================================================================
# Maximum note content length to send to LLM
MAX_NOTE_LENGTH=50000

# Maximum notes to retrieve per patient for context
MAX_NOTES_PER_PATIENT=20

# =============================================================================
# Epic FHIR (if using Epic with SMART on FHIR)
# =============================================================================
# EPIC_CLIENT_ID=
# EPIC_PRIVATE_KEY_PATH=
# EPIC_FHIR_BASE_URL=

# =============================================================================
# NHSN DIRECT Protocol Submission (Optional)
# =============================================================================
# Enable automated submission to NHSN via DIRECT protocol.
# Requires a HISP (Health Information Service Provider) account.
# Contact your HISP or see: https://www.cdc.gov/nhsn/cdaportal/importingdata.html

# Your organization's NHSN Facility ID and name
# NHSN_FACILITY_ID=
# NHSN_FACILITY_NAME=

# HISP SMTP Server Settings
# Contact your HISP provider for these credentials
# NHSN_HISP_SMTP_SERVER=
# NHSN_HISP_SMTP_PORT=587
# NHSN_HISP_SMTP_USERNAME=
# NHSN_HISP_SMTP_PASSWORD=
# NHSN_HISP_USE_TLS=true

# DIRECT Protocol Addresses
# Your organization's DIRECT address (from HISP)
# NHSN_SENDER_DIRECT_ADDRESS=yourorg@direct.yourhisp.com
# NHSN's DIRECT address (provided when you sign up for DIRECT in NHSN)
# NHSN_DIRECT_ADDRESS=

# Optional: S/MIME Certificates (if required by your HISP)
# NHSN_SENDER_CERT_PATH=/path/to/your-cert.pem
# NHSN_SENDER_KEY_PATH=/path/to/your-key.pem
# NHSN_CERT_PATH=/path/to/nhsn-cert.pem
